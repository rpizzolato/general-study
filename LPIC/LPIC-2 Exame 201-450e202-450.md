# LPIC-2 Exam 450

## Tópico 200: Planejamento de capacidade
## Tópico 201: O Kernel Linux
## Tópico 202: Início do sistema
## Tópico 203: Sistemas de arquivos e Dispositivos
## Tópico 204: Administração avançada de dispositivos de armazenamento
## Tópico 205: Configuração de rede
## Tópico 206: Manutenção do Sistema

## Tópico 207: Servidor de Nomes de Domínio

DNS: Domain Name System
- sistema responsável por traduzir nomes de máquinas para IPs e vice-versa (DNS reverso)
- infraestrutura distribuída.

### Domain Name Space

- É aquela famosa imagem da árvore de ponta cabeça, onde o tronco da árvore é o ponto (`.`), no caso é o **Root Domain**

	- **TLD (Top Level Domains)**: seria logo após o ponto, começando a raiz da árvore, onde ficaria `.edu.`, `.us.`, `.org.`, `.in.`, `.com.` (terminam com ponto! É o ponto do tronco da árvore, que significa o `Root Domain` - lembrando que nos navegadores apenas omitimos esse ponto ao navegar na Internet, no entanto se digitar o ponto, vai funcionar normalmente)

		- **First Level Domains**: `ubuntu.com.`, `lpi.org.`, `redhat.com.`, `iupui.edu.`, etc

			- **Hosts / Subdomains**: `www.ubuntu.com.`, `www.forums.opensuse.org.`, `www.jobs.redhar.com.`. Seria o host que quer chegar, com o IP propriamente dito, host final.

- Voltando ao tronco, temos o **The Root Zone**, **Name Servers (NS)** e **Root Servers**.

	- Separados por zonas, têm os **Name Servers (NS)**, que podem ser separados por zonas, no caso zonas **.com**, **.org**, etc.  Vamos supor que essa seja a zona **.com**:
		- dentro temos os domínios **.com**, no caso, por exemplo, **redhat.com. Zone**

### Tipos de Name Servers (NS)

- **Primary (Master)**: 
	- precisa ter pelo menos 2, sendo 1 deles sendo o Master (poderia ser Master e Slave, Master e Caching, Master e Forwarding - precisa ser 2 pelo menos)
	- como visto antes, ele é obrigatório, sendo um Authoritative Server: que no caso possui autoridade sobre o domínio
- **Secondary (Slave)**:
	- opcional (padrão ou mais comum é ter um master e um slave)
	- também considerado como Authoritative Server
	- recebe as informações do Master, e caso o Master caia, ele assume como Master
- **Caching**:
	- opcional (geralmente é o primeiro a ser configurado, que já vem com o bind, quando for realizar as configurações)
	- não tem autoridade sobre o domínio
	- recebe as informações de outro NS (master ou slave), armazena localmente, faz e retorna as consultas (recursivamente)
- **Forwarding**:
	- opcional
	- pode ser considerado um tipo de "caching server"
	- encaminha a consulta para que outro servidor resolva e armazene o resultado localmente em cache

### DNS Resolver

- Software ou biblioteca responsável por fazer a consulta de DNS
- utilizado no sistema loca (DNS Client) e também é parte do DNS Server
- normalmente armazena os resultados em cache

**Exemplo:** Ao digitar **www.redhat.com** no navegador, seu navegador vai perguntar (conhecido como *query*) ao Sistema Operacional se ele sabe em qual IP deve ir para chegar no site da redhat, olhando o arquio `/etc/hosts`.<br>
Caso não ache, ele vai perguntar para o servidor DNS, no caso, no arquivo `/etc/resolv.conf`, para o servidor que estiver em `nameserver` (Ex. `nameserver 192.168.0.53`), sendo esse servidor assumir a função de **Resolver**.<br>
Sendo o Resolver, eles conhecem quem são os Root Servers, e pergunta quem é o **www.redhat.com**. Caso não saiba, será perguntado para os Name Servers responsáveis pelo **redhat**. Encontrando o IP, é entregue no caminho inverso até o navegador que solicitou.

Resumidamente, o ponto (`.`) não sabe quem é **www.redhat.com**, ele apenas sabe quem é o **.com** (que seria o próximo na hierarquia), já o **.com** sabe quem é **www.redhat.com**. E isso vai sendo guardado em cache, para evitar fazer todo caminho novamente em uma nova requisição.

### BIND (software que implementa o recurso de DNS - para ser usado como um servidor DNS)
 
- Open Source DNS Server
- BIND: Berkley Internet Domain Server
- implementa o protocolo DNS
- implementação de DNS Server mais utilizada
- LPI cobra o BIND 9.x

### Alternativas ao BIND

- **djbdns**: implementação criada por Daniel J. Bernstein
- **dnsmasq**: combinação leve de um DNS Caching com DHCP (usado internamente para que ele mesmo faça as consultas de DNS, geralmente presente em distros com interface gráfica - interessante para redes pequenas)
- **PowerDNS**: implementação DNS de grande porte (concorrente do BIND)

## 207.1 Configuração básica de um servidor DNS

- Primeiramente, instalar os pacotes `bind` e `bind-utils` no CentOS (Redhat)
- No Debian: `bind9` e `dnsutils`

- No Redhat o arquivo de configuração fica em `/etc/named.conf`(tudo em um arquivo)
- No Debian fica em `/etc/bind/named.conf`, que aponta para outros arquivos:
	- `/etc/bind/named.conf.options`
	- `/etc/bind/named.conf.local`
	- `/etc/bind/named.conf.default-zones`

As zonas de domínio ficam sempre em `/var/named`. É aqui também que fica o arquivo `named.ca`, onde ficam as listas dos grupos de servidores **root domain** (a nível do ponto `.`). No Debian esse arquivo fica em `/etc/bind/db.root` (o nome muda também).


- `/etc/named.conf` e `/etc/bind/named.conf.options`: onde é configurado na divisão **options { }**, tudo relacionado às configurações do bind.

A primeira opção dentro do espaço:<br>

    options {
	    listen-on port 53 { 127.0.0.1; }
    }

Tem a porta, no caso a porta que o DNS ouve é a **53**(consultas/queries), utilizando UDP. Se for transferência de zona (o slave transferindo do master, é utilizado por TCP). O ip 
<!--stackedit_data:
eyJoaXN0b3J5IjpbNzE3NjU4NTgwLDIzMjYwNzM0Nyw5NzMxNz
YwODUsLTM5NDk1MzI1MiwtMTA4ODIzMTg5NSw0NTYxMDYyMTgs
MTIzMDExMjc1NCwtMTg2MjU5MTAyNywxMTk5MDA3NjYyLC0xNj
Y3NzIxMTg4LC05NjM4NzA0NTAsLTgyMTgyNDYyMiw2NDU1ODU1
NTgsMTU2MTAzMjQwMl19
-->